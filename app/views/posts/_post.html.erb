<tr>
  <td><%= post.visit_date.strftime('%Y-%m-%d') if post.visit_date %></td>
  <td><%= post.shop&.name %></td>
  <td><%= post.category&.name %></td>
  <td><%= [post.shop&.location&.prefecture&.name, post.shop&.location&.city&.name].compact.join(' ') %></td>
  <td><%= post.companion&.name %></td>
  <td><%= post.feeling&.name %></td>
  <td><%= post.visit_reason&.name %></td>

  <% visit = @visits_by_shop[post.shop_id] %>
  <td class="text-center visit-count" id="visit-count-<%= post.id %>">
    <%= visit&.count.to_i %>
    <% if show_history_button %>
      <%= link_to t('defaults.actions.history_visit'), history_post_path(post), class: "btn btn-sm btn-outline-primary ms-2" %>
    <% end %>
  </td>

  <td class="text-center" id="favorite-button-<%= post.id %>">
    <% if current_user.favorites.exists?(post_id: post.id) %>
      <%= button_to post_favorite_path(post), method: :delete, class: 'btn btn-link p-0' do %>
        <i class="fas fa-heart text-danger"></i>
      <% end %>
    <% else %>
      <%= button_to post_favorite_path(post), method: :post, class: 'btn btn-link p-0' do %>
        <i class="far fa-heart text-secondary"></i>
      <% end %>
    <% end %>
  </td>

  <td>
    <%= link_to t('defaults.actions.show'), post_path(post), class: 'btn btn-sm btn-outline-primary me-1' %>
    <%= link_to t('defaults.actions.edit'), edit_post_path(post), class: 'btn btn-sm btn-outline-secondary' %>
  </td>
</tr>
